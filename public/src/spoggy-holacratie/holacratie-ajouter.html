<link rel="import" href="../../bower_components/polymer/polymer-element.html">
<link rel="import" href="../../bower_components/polymer/lib/utils/render-status.html">
<link rel="import" href="../../bower_components/lazy-imports/lazy-imports-mixin.html">
<link rel="import" href="./holacratie-behavior.html">

<dom-module id="holacratie-ajouter">
  <!--<link rel="lazy-import" group="lazy" href="./holacratie-import.html">-->

  <link rel="lazy-import" group="lazy" href="../../bower_components/paper-input/paper-input.html">
  <link rel="lazy-import" group="lazy" href="../../bower_components/polymer/lib/elements/dom-repeat.html">
  <link rel="lazy-import" group="lazy" href="./holacratie-fields.html">
  <template>
    <style>
    :host {
      display: block;
    }
    </style>
    [[prop1]] [[name]]<br>
    url="[[url]]"<br> definition="[[definition]]"<br>
    <paper-button raised on-tap="_loadModule">TEST</paper-button>
    <paper-card  image="[[image(item.image)]]" alt="Ce endpoint ne semble pas accessible" justified>
      <div class="card-content">
        <div class="cafe-header">   <h2 style="margin: 0;color: #0D578B;">Cr√©er un(e) [[name]] :  </h2>
        </div>
        <p class="cafe-light">
          <div style="padding-top:10px" horizontal end-justified layout self-stretch>
            <paper-input id="nomInput" label="nom" value={{nom}}></paper-input>
            <!--<template is="dom-repeat" items="[[fields]]">
            <span mode="[[mode]]" holaroot="[[holaroot]]" name="[[item.name]]" url="[[item.url]]" definition="[[item.definition]]">- [[item.name]] / [[item.type]]</span><br>
          </template>-->
          <holacratie-fields fields="[[fields]]"></holacratie-fields>
        </div>
      </p>
    </div>
  </paper-card>
</template>

<script>
/**
* `spoggy-holacratie`
*
*
* @customElement
* @polymer
* @demo demo/index.html
*/
class HolacratieAjouter extends Polymer.LazyImportsMixin(HolacratieBehaviorMixin(Polymer.Element)) {
  static get is() { return 'holacratie-ajouter'; }
  static get properties() {
    return {
      prop1: {
        type: String,
        value: 'holacratie-ajouter'
      },
      mode: {
        type: String,
        notify: true
      },
      name: {
        type: String,
        notify: true
      },
      fields: {
        type: Array,
        notify: true,
        value: []
      },
    };
  }

  constructor(){
    super();
    Polymer.RenderStatus.afterNextRender(this, function() {
      this._deferred();
      console.log(this.url, this.definition)
      //  this._loadModule()
    });
  }
  _deferred(){
    this.importLazyGroup('lazy').then((results) => {
      console.log(results);
      this.dispatchEvent(new CustomEvent('import-loaded', results));
      /*this.agentHolacratie = new HolacratieAgent('agentHolacratie', this);*/
    });
  }

  isEqual(mode, test){
    console.log(mode, test, mode==test)
    return mode == test;
  }
}

window.customElements.define(HolacratieAjouter.is, HolacratieAjouter);
</script>
</dom-module>
